<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCEND Hypothesis Testing Calculator</title>
    <style>
        :root {
            /* ASCEND Brand Colors */
            --primary-black: #000000;
            --primary-white: #ffffff;
            --accent-crimson: #8B0020;
            --secondary-olive: #2d3d1f;
            --neutral-offwhite: #F8F4E6;
            --neutral-gray-600: #666666;
            --neutral-gray-300: #cccccc;
            --neutral-gray-100: #f5f5f5;
            
            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 40px;
            --space-xxl: 60px;
            --space-xxxl: 80px;
            
            /* Typography */
            --font-primary: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            
            /* Animation */
            --transition-normal: 300ms ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-primary);
            background: var(--primary-white);
            color: var(--primary-black);
            line-height: 1.8;
            font-weight: 300;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: var(--space-xl) var(--space-lg);
        }
        
        /* Header Styles */
        .header {
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            padding-bottom: var(--space-xxl);
            margin-bottom: var(--space-xxl);
        }
        
        .header h1 {
            font-size: 4rem;
            font-weight: 200;
            letter-spacing: -0.02em;
            line-height: 1.1;
            margin-bottom: var(--space-md);
        }
        
        .accent {
            color: var(--accent-crimson);
        }
        
        .tagline {
            color: var(--secondary-olive);
            font-size: 1.2rem;
            letter-spacing: 0.01em;
            margin-bottom: var(--space-lg);
        }
        
        .accent-line {
            width: 60px;
            height: 2px;
            background: var(--accent-crimson);
            margin: var(--space-lg) 0;
        }
        
        .guide-link {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            background: transparent;
            border: 1px solid var(--accent-crimson);
            color: var(--accent-crimson);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            border-radius: 4px;
            transition: var(--transition-normal);
            margin-top: var(--space-md);
        }
        
        .guide-link:hover {
            background: var(--accent-crimson);
            color: var(--primary-white);
        }
        
        .guide-link-icon {
            font-size: 1rem;
        }
        
        /* Section Headers */
        .section-title {
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--primary-black);
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--neutral-gray-300);
        }
        
        /* Wizard Styles */
        .wizard-container {
            background: var(--neutral-offwhite);
            padding: var(--space-xl);
            border-radius: 8px;
            margin-bottom: var(--space-xl);
        }
        
        .wizard-steps {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            justify-content: center;
        }
        
        .wizard-step {
            flex: 1;
            max-width: 200px;
            padding: var(--space-lg);
            background: var(--primary-white);
            border: 2px solid var(--neutral-gray-300);
            border-radius: 8px;
            text-align: center;
            transition: var(--transition-normal);
            cursor: pointer;
        }
        
        .wizard-step.active {
            border-color: var(--accent-crimson);
            background: var(--primary-white);
            box-shadow: 0 4px 12px rgba(139, 0, 32, 0.1);
        }
        
        .wizard-step.completed {
            border-color: var(--secondary-olive);
            background: rgba(45, 61, 31, 0.05);
        }
        
        .wizard-step .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--neutral-gray-300);
            color: var(--primary-black);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-sm);
            font-weight: 600;
            transition: var(--transition-normal);
        }
        
        .wizard-step.active .step-number {
            background: var(--accent-crimson);
            color: var(--primary-white);
        }
        
        .wizard-step.completed .step-number {
            background: var(--secondary-olive);
            color: var(--primary-white);
        }
        
        .wizard-step .step-title {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: var(--space-xs);
        }
        
        .wizard-step .step-subtitle {
            font-size: 0.75rem;
            color: var(--neutral-gray-600);
        }
        
        .wizard-content {
            background: var(--primary-white);
            padding: var(--space-xl);
            border-radius: 8px;
            min-height: 250px;
        }
        
        .wizard-content-step {
            display: none;
        }
        
        .wizard-content-step.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .wizard-buttons {
            display: flex;
            gap: var(--space-md);
            justify-content: space-between;
            margin-top: var(--space-xl);
        }
        
        /* Tooltip Styles */
        .tooltip-container {
            position: relative;
            display: inline-block;
        }
        
        .tooltip-trigger {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-crimson);
            color: var(--primary-white);
            font-size: 0.75rem;
            font-weight: 600;
            cursor: help;
            margin-left: var(--space-sm);
        }
        
        .tooltip-content {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-black);
            color: var(--primary-white);
            padding: var(--space-md);
            border-radius: 8px;
            width: 300px;
            font-size: 0.875rem;
            line-height: 1.6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-normal);
        }
        
        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--primary-black);
        }
        
        .tooltip-container:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
        }
        
        .tooltip-example {
            margin-top: var(--space-sm);
            padding-top: var(--space-sm);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .tooltip-example strong {
            color: var(--accent-crimson);
            color: #ff6b85;
        }
        
        /* Form Styles */
        .form-section {
            margin-bottom: var(--space-xxxl);
        }
        
        .section {
            margin-bottom: var(--space-xxxl);
        }
        
        .input-group {
            margin-bottom: var(--space-xl);
        }
        
        .input-group label {
            display: block;
            font-weight: 400;
            font-size: 1rem;
            margin-bottom: var(--space-sm);
            color: var(--primary-black);
        }
        
        .help-text {
            font-size: 0.875rem;
            color: var(--neutral-gray-600);
            margin-top: var(--space-xs);
            font-weight: 300;
        }
        
        .input-group input, .input-group textarea {
            width: 100%;
            padding: var(--space-md);
            border: 1px solid var(--neutral-gray-300);
            background: var(--primary-white);
            font-family: inherit;
            font-size: 1rem;
            font-weight: 300;
            transition: var(--transition-normal);
        }
        
        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: var(--primary-black);
        }
        
        .input-group textarea {
            min-height: 100px;
            resize: vertical;
            line-height: 1.6;
        }
        
        /* Radio Group */
        .radio-group {
            display: flex;
            gap: var(--space-lg);
            align-items: center;
            flex-wrap: wrap;
        }
        
        .radio-group label {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-weight: 300;
            cursor: pointer;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--neutral-gray-300);
            border-radius: 8px;
            transition: var(--transition-normal);
        }
        
        .radio-group label:hover {
            border-color: var(--primary-black);
        }
        
        .radio-group input[type="radio"]:checked + span {
            font-weight: 600;
        }
        
        .radio-group label:has(input:checked) {
            border-color: var(--accent-crimson);
            background: rgba(139, 0, 32, 0.05);
        }
        
        .radio-group input[type="radio"] {
            width: auto;
            margin: 0;
        }
        
        /* Tag Input Styles */
        .tag-input-container {
            background: var(--primary-white);
            border: 1px solid var(--neutral-gray-300);
            border-radius: 8px;
            padding: var(--space-sm);
            min-height: 100px;
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            align-items: flex-start;
            transition: var(--transition-normal);
        }
        
        .tag-input-container:focus-within {
            border-color: var(--primary-black);
        }
        
        .tag {
            background: var(--accent-crimson);
            color: var(--primary-white);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 6px;
            animation: tagAppear 0.2s ease-out;
        }
        
        @keyframes tagAppear {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        .tag-remove {
            cursor: pointer;
            font-weight: bold;
            opacity: 0.8;
            transition: opacity 0.2s;
        }
        
        .tag-remove:hover {
            opacity: 1;
        }
        
        .tag-input {
            flex: 1;
            min-width: 150px;
            border: none;
            outline: none;
            padding: 6px 12px;
            font-family: inherit;
            font-size: 0.875rem;
        }
        
        .suggested-tags {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
            margin-top: var(--space-sm);
        }
        
        .suggested-tag {
            padding: 4px 12px;
            background: var(--neutral-gray-100);
            border: 1px solid var(--neutral-gray-300);
            border-radius: 20px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition-normal);
        }
        
        .suggested-tag:hover {
            background: var(--neutral-offwhite);
            border-color: var(--accent-crimson);
        }
        
        /* Slider Styles */
        .slider-container {
            background: var(--neutral-offwhite);
            padding: var(--space-lg);
            border-radius: 8px;
            margin-top: var(--space-md);
        }
        
        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
            flex-wrap: wrap;
            gap: var(--space-sm);
        }
        
        .slider-value {
            font-size: 2rem;
            font-weight: 200;
            color: var(--accent-crimson);
        }
        
        .slider-input {
            -webkit-appearance: none;
            width: 100%;
            height: 4px;
            background: var(--neutral-gray-300);
            outline: none;
            transition: var(--transition-normal);
        }
        
        .slider-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--accent-crimson);
            cursor: pointer;
            border-radius: 50%;
            transition: var(--transition-normal);
        }
        
        .slider-input::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 0 8px rgba(139, 0, 32, 0.1);
        }
        
        .slider-input::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--accent-crimson);
            cursor: pointer;
            border-radius: 50%;
            border: none;
            transition: var(--transition-normal);
        }
        
        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: var(--space-sm);
            font-size: 0.75rem;
            color: var(--neutral-gray-600);
        }
        
        /* Two Column Grid */
        .metric-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        /* Button Styles */
        .button-group {
            display: flex;
            gap: var(--space-md);
            margin: var(--space-xl) 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 20px 60px;
            font-size: 0.9rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: 400;
            cursor: pointer;
            transition: var(--transition-normal);
            border: 1px solid;
            background: transparent;
        }
        
        .btn-primary {
            background: var(--primary-black);
            color: var(--primary-white);
            border-color: var(--primary-black);
        }
        
        .btn-primary:hover {
            background: var(--accent-crimson);
            border-color: var(--accent-crimson);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--primary-black);
            border-color: var(--primary-black);
        }
        
        .btn-secondary:hover {
            background: var(--primary-black);
            color: var(--primary-white);
        }
        
        .btn-wizard {
            padding: 12px 30px;
            font-size: 0.875rem;
        }
        
        /* Message Testing Section */
        .message-testing {
            background: var(--neutral-offwhite);
            padding: var(--space-xl);
            border-radius: 8px;
            margin: var(--space-xl) 0;
        }
        
        .offer-counter {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: var(--space-sm);
            margin: var(--space-md) 0;
        }
        
        .offer-number {
            padding: var(--space-sm);
            border: 1px solid var(--neutral-gray-300);
            text-align: center;
            cursor: pointer;
            transition: var(--transition-normal);
            font-size: 0.875rem;
            background: var(--primary-white);
        }
        
        .offer-number:hover {
            border-color: var(--primary-black);
        }
        
        .offer-number.completed {
            background: var(--accent-crimson);
            color: var(--primary-white);
            border-color: var(--accent-crimson);
        }
        
        /* Results Section */
        .results {
            display: none;
            margin-top: var(--space-xxxl);
            padding-top: var(--space-xxl);
            border-top: 1px solid var(--neutral-gray-300);
            animation: fadeIn 0.5s ease-out;
        }
        
        .results h3 {
            font-size: 2rem;
            font-weight: 300;
            margin-bottom: var(--space-xl);
            letter-spacing: -0.01em;
        }
        
        /* Result Cards */
        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xxl);
        }
        
        .result-card {
            padding: var(--space-xl) var(--space-lg);
            border: 1px solid var(--neutral-gray-300);
            background: var(--primary-white);
            transition: var(--transition-normal);
        }
        
        .result-card:hover {
            border-color: var(--primary-black);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        }
        
        .result-card.primary {
            border-color: var(--accent-crimson);
            background: var(--neutral-offwhite);
        }
        
        .result-card-title {
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--neutral-gray-600);
            margin-bottom: var(--space-sm);
        }
        
        .result-card-value {
            font-size: 2rem;
            font-weight: 200;
            color: var(--primary-black);
            line-height: 1;
            margin-bottom: var(--space-xs);
        }
        
        .result-card.primary .result-card-value {
            color: var(--accent-crimson);
        }
        
        .result-card-subtitle {
            font-size: 0.75rem;
            color: var(--neutral-gray-600);
            font-weight: 300;
        }
        
        /* Status Boxes */
        .status-box {
            padding: var(--space-xl);
            margin: var(--space-xl) 0;
            border: 1px solid;
            position: relative;
        }
        
        .status-box::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
        }
        
        .warning-box {
            background: rgba(139, 0, 32, 0.03);
            border-color: var(--accent-crimson);
            color: var(--primary-black);
        }
        
        .warning-box::before {
            background: var(--accent-crimson);
        }
        
        .success-box {
            background: rgba(45, 61, 31, 0.03);
            border-color: var(--secondary-olive);
            color: var(--primary-black);
        }
        
        .success-box::before {
            background: var(--secondary-olive);
        }
        
        .status-box strong {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: var(--space-sm);
        }
        
        /* Comparison Dashboard */
        .dashboard {
            margin-top: var(--space-xxxl);
            padding-top: var(--space-xxl);
            border-top: 2px solid var(--neutral-gray-300);
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xl);
            flex-wrap: wrap;
            gap: var(--space-md);
        }
        
        .dashboard-tabs {
            display: flex;
            gap: var(--space-sm);
            border-bottom: 2px solid var(--neutral-gray-300);
            margin-bottom: var(--space-xl);
            overflow-x: auto;
        }
        
        .dashboard-tab {
            padding: var(--space-md) var(--space-lg);
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: var(--neutral-gray-600);
            white-space: nowrap;
            transition: var(--transition-normal);
        }
        
        .dashboard-tab.active {
            border-bottom-color: var(--accent-crimson);
            color: var(--accent-crimson);
        }
        
        .dashboard-tab:hover:not(.active) {
            color: var(--primary-black);
        }
        
        .export-buttons {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
        }
        
        .export-btn {
            padding: 10px 20px;
            border: 1px solid var(--primary-black);
            background: var(--primary-white);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            border-radius: 4px;
            font-size: 0.875rem;
            transition: var(--transition-normal);
        }
        
        .export-btn:hover {
            background: var(--primary-black);
            color: var(--primary-white);
        }
        
        .comparison-table-container {
            overflow-x: auto;
            margin-bottom: var(--space-xl);
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .comparison-table thead {
            background: var(--primary-black);
            color: var(--primary-white);
        }
        
        .comparison-table th {
            padding: var(--space-md);
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
            cursor: pointer;
            user-select: none;
        }
        
        .comparison-table th:hover {
            background: var(--accent-crimson);
        }
        
        .comparison-table td {
            padding: var(--space-md);
            border-bottom: 1px solid var(--neutral-gray-300);
            font-size: 0.875rem;
        }
        
        .comparison-table tbody tr {
            transition: var(--transition-normal);
        }
        
        .comparison-table tbody tr:hover {
            background: var(--neutral-offwhite);
        }
        
        .status-badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
        }
        
        .status-badge.validated {
            background: var(--secondary-olive);
            color: var(--primary-white);
        }
        
        .status-badge.partial {
            background: #ffaa00;
            color: var(--primary-white);
        }
        
        .status-badge.insufficient {
            background: var(--accent-crimson);
            color: var(--primary-white);
        }
        
        .action-buttons {
            display: flex;
            gap: var(--space-sm);
        }
        
        .action-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        
        .action-btn:hover {
            opacity: 1;
        }
        
        .empty-state {
            text-align: center;
            padding: var(--space-xxxl) var(--space-lg);
            color: var(--neutral-gray-600);
        }
        
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: var(--space-md);
            opacity: 0.3;
        }
        
        /* Mobile Quick Entry */
        .mobile-quick-entry {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--primary-white);
            border-top: 2px solid var(--neutral-gray-300);
            padding: var(--space-lg);
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.3s ease-out;
        }
        
        .mobile-quick-entry.active {
            transform: translateY(0);
        }
        
        .mobile-quick-entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }
        
        .mobile-quick-entry-close {
            background: transparent;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .mobile-quick-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-sm);
        }
        
        .mobile-quick-btn {
            padding: var(--space-lg);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-sm);
            transition: var(--transition-normal);
        }
        
        .mobile-quick-btn.primary {
            background: var(--accent-crimson);
            color: var(--primary-white);
        }
        
        .mobile-quick-btn.secondary {
            background: var(--primary-black);
            color: var(--primary-white);
        }
        
        .mobile-quick-btn:active {
            transform: scale(0.95);
        }
        
        .mobile-quick-btn-icon {
            font-size: 1.5rem;
        }
        
        .mobile-fab {
            display: none;
            position: fixed;
            bottom: var(--space-lg);
            right: var(--space-lg);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--accent-crimson);
            color: var(--primary-white);
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(139, 0, 32, 0.3);
            z-index: 999;
            transition: var(--transition-normal);
        }
        
        .mobile-fab:active {
            transform: scale(0.9);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header h1 { font-size: 2.5rem; }
            .metric-grid { grid-template-columns: 1fr; }
            .result-grid { grid-template-columns: 1fr; }
            .button-group { flex-direction: column; }
            .btn { width: 100%; }
            .offer-counter { grid-template-columns: repeat(5, 1fr); }
            
            .guide-link {
                display: flex;
                justify-content: center;
                width: 100%;
            }
            
            .wizard-steps {
                flex-direction: column;
            }
            
            .wizard-step {
                max-width: 100%;
            }
            
            .radio-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            .radio-group label {
                justify-content: center;
            }
            
            .mobile-quick-entry {
                display: block;
            }
            
            .mobile-fab {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .tooltip-content {
                width: 250px;
                left: auto;
                right: 0;
                transform: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ASCEND<span class="accent">.</span></h1>
            <p class="tagline">Hypothesis Testing Calculator</p>
            <div class="accent-line"></div>
            <p style="margin-top: var(--space-lg); color: var(--neutral-gray-600);">
                Track, test, and validate your market hypotheses. Make data-driven decisions.
            </p>
            <a href="https://coe-nexus.github.io/ld-embeds/embeds/hypothesis-calc/QUICK-START-GUIDE.md" 
               download="ASCEND-Quick-Start-Guide.md" 
               class="guide-link">
                <span class="guide-link-icon">📘</span>
                Download Quick Start Guide
            </a>
        </header>
        
        <!-- Form Section -->
        <div class="form-section">
            <!-- Hypothesis Definition -->
            <div class="section">
                <h2 class="section-title">Hypothesis Definition</h2>
                <div class="input-group">
                    <label for="hypothesis">Hypothesis / Epic Name</label>
                    <input type="text" id="hypothesis" placeholder="e.g., LinkedIn outreach for B2B SaaS founders">
                    <div class="help-text">What are you testing? Be specific about the channel, message, or approach.</div>
                </div>
                
                <div class="input-group">
                    <label for="messageEquation">Value Proposition</label>
                    <input type="text" id="messageEquation" placeholder="I help [niche] to [get result] by [your offer]">
                    <div class="help-text">Define your value proposition clearly</div>
                </div>
                
                <div class="input-group">
                    <label for="version">Version #</label>
                    <input type="number" id="version" placeholder="1" min="1" value="1">
                    <div class="help-text">Which iteration of this hypothesis is this?</div>
                </div>
            </div>
            
            <!-- Impact Unit Wizard -->
            <div class="section">
                <h2 class="section-title">
                    Impact Unit Settings
                    <div class="tooltip-container">
                        <div class="tooltip-trigger">i</div>
                        <div class="tooltip-content">
                            <strong>What is an Impact Unit?</strong>
                            <p>An impact unit helps you measure success consistently across all hypotheses.</p>
                            <div class="tooltip-example">
                                <strong>SaaS Startup:</strong> 1 unit = 100 users = $15k ARR<br><br>
                                <strong>E-commerce:</strong> 1 unit = 500 customers = $50k revenue<br><br>
                                <strong>Agency:</strong> 1 unit = 5 clients = $25k MRR
                            </div>
                        </div>
                    </div>
                </h2>
                
                <div class="wizard-container" id="impactWizard">
                    <div class="wizard-steps">
                        <div class="wizard-step active" data-step="1">
                            <div class="step-number">1</div>
                            <div class="step-title">Choose Basis</div>
                            <div class="step-subtitle">Users or Revenue?</div>
                        </div>
                        <div class="wizard-step" data-step="2">
                            <div class="step-number">2</div>
                            <div class="step-title">Set Scale</div>
                            <div class="step-subtitle">Define your unit</div>
                        </div>
                        <div class="wizard-step" data-step="3">
                            <div class="step-number">3</div>
                            <div class="step-title">Confirm</div>
                            <div class="step-subtitle">Review & proceed</div>
                        </div>
                    </div>
                    
                    <div class="wizard-content">
                        <!-- Step 1: Choose Basis -->
                        <div class="wizard-content-step active" data-step="1">
                            <h3 style="margin-bottom: var(--space-md);">What do you want to measure?</h3>
                            <div class="radio-group" style="flex-direction: column;">
                                <label>
                                    <input type="radio" name="impactBasis" value="users" checked>
                                    <span>Users/Customers - Track user acquisition</span>
                                </label>
                                <label>
                                    <input type="radio" name="impactBasis" value="revenue">
                                    <span>Revenue (ARR) - Track annual recurring revenue</span>
                                </label>
                                <label>
                                    <input type="radio" name="impactBasis" value="both">
                                    <span>Both - Track users and revenue together</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Step 2: Set Scale -->
                        <div class="wizard-content-step" data-step="2">
                            <h3 style="margin-bottom: var(--space-md);">Define your unit scale</h3>
                            <div class="metric-grid">
                                <div class="input-group" id="usersPerUnitGroup">
                                    <label for="usersPerUnit">Users per Unit</label>
                                    <input type="number" id="usersPerUnit" value="100" min="1" step="1">
                                    <div class="help-text">How many users = 1 impact unit?</div>
                                </div>
                                <div class="input-group" id="revenuePerUnitGroup">
                                    <label for="revenuePerUnit">ARR ($) per Unit</label>
                                    <input type="number" id="revenuePerUnit" value="15000" min="1" step="100">
                                    <div class="help-text">How much ARR = 1 impact unit?</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Step 3: Confirm -->
                        <div class="wizard-content-step" data-step="3">
                            <h3 style="margin-bottom: var(--space-md);">Confirm your impact unit</h3>
                            <div style="background: var(--neutral-offwhite); padding: var(--space-lg); border-radius: 8px;">
                                <p style="font-size: 1.1rem; margin-bottom: var(--space-md);"><strong>Your Impact Unit:</strong></p>
                                <p style="font-size: 1.5rem; color: var(--accent-crimson); font-weight: 300;" id="wizardSummary">
                                    1 unit = 100 users or $15,000 ARR
                                </p>
                                <p style="margin-top: var(--space-md); color: var(--neutral-gray-600);">
                                    This means when you score 1.0 impact, you've achieved your target of <span id="wizardTargetUsers">100 users</span> or <span id="wizardTargetRevenue">$15,000 ARR</span>.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="wizard-buttons">
                        <button class="btn btn-secondary btn-wizard" id="wizardPrev" style="display: none;">← Previous</button>
                        <div style="flex: 1;"></div>
                        <button class="btn btn-primary btn-wizard" id="wizardNext">Next →</button>
                    </div>
                </div>
            </div>
            
            <!-- Execution Metrics -->
            <div class="section">
                <h2 class="section-title">Execution Metrics</h2>
                
                <div class="metric-grid">
                    <div class="input-group">
                        <label for="timeSpent">Time Invested (hours)</label>
                        <input type="number" id="timeSpent" placeholder="20" min="0" step="0.5">
                        <div class="help-text">Total hours spent on this hypothesis</div>
                    </div>
                    
                    <div class="input-group">
                        <label for="hourlyRate">Your Hourly Rate ($)</label>
                        <input type="number" id="hourlyRate" placeholder="100" min="1">
                        <div class="help-text">For ROI calculation</div>
                    </div>
                </div>
                
                <div class="slider-container">
                    <div class="slider-header">
                        <label for="completionSlider">Completion Status (Honest Assessment)</label>
                        <div class="slider-value" id="completionValue">50%</div>
                    </div>
                    <input type="range" class="slider-input" id="completionSlider" min="0" max="100" value="50" step="5">
                    <div class="slider-labels">
                        <span>0% - Just Started</span>
                        <span>50% - Halfway</span>
                        <span>100% - Fully Executed</span>
                    </div>
                </div>
            </div>
            
            <!-- Impact Assessment -->
            <div class="section">
                <h2 class="section-title">Impact Assessment</h2>
                
                <div class="slider-container">
                    <div class="slider-header">
                        <label for="impactSlider">Impact Score <span id="impactUnitLabel" style="font-weight: 300; font-size: 0.875rem;">(1 unit = 100 users or $15k ARR)</span></label>
                        <div class="slider-value" id="impactValue">0.5</div>
                    </div>
                    <input type="range" class="slider-input" id="impactSlider" min="0" max="5" value="0.5" step="0.1">
                    <div class="slider-labels">
                        <span>0 - No Impact</span>
                        <span>1 - Target Hit</span>
                        <span>5 - 5x Target</span>
                    </div>
                    <div class="help-text" style="margin-top: var(--space-md);">
                        Current impact: <span id="impactCustomers">50</span> customers or $<span id="impactRevenue">7,500</span> ARR
                    </div>
                </div>
                
                <div class="slider-container" style="margin-top: var(--space-lg);">
                    <div class="slider-header">
                        <label for="confidenceSlider">Confidence in Data Quality</label>
                        <div class="slider-value" id="confidenceValue">70%</div>
                    </div>
                    <input type="range" class="slider-input" id="confidenceSlider" min="0" max="100" value="70" step="5">
                    <div class="slider-labels">
                        <span>0% - Pure Guess</span>
                        <span>50% - Some Data</span>
                        <span>100% - Verified</span>
                    </div>
                </div>
            </div>
            
            <!-- Message Testing -->
            <div class="section">
                <h2 class="section-title">Market Feedback Tracking</h2>
                <div class="message-testing">
                    <p style="margin-bottom: var(--space-md);">Track your offer presentations (click to mark complete):</p>
                    <div class="offer-counter" id="offerCounter">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <p style="margin-top: var(--space-md); font-size: 0.875rem; color: var(--neutral-gray-600);">
                        Offers made: <span id="offerCount">0</span> / 30 (minimum for validation)
                    </p>
                </div>
                
                <div class="input-group">
                    <label for="resonatingPhrases">What Resonated? (Click to add tags)</label>
                    <div class="tag-input-container" id="resonatingTagsContainer">
                        <input type="text" class="tag-input" id="resonatingInput" placeholder="Type and press Enter to add tags...">
                    </div>
                    <div class="suggested-tags">
                        <div class="suggested-tag" data-tag="time-saving">💡 time-saving</div>
                        <div class="suggested-tag" data-tag="affordable">💰 affordable</div>
                        <div class="suggested-tag" data-tag="easy-to-use">✨ easy-to-use</div>
                        <div class="suggested-tag" data-tag="fast-results">⚡ fast-results</div>
                        <div class="suggested-tag" data-tag="great-support">🤝 great-support</div>
                        <div class="suggested-tag" data-tag="roi">📈 roi</div>
                    </div>
                    <div class="help-text">Common themes: pricing, speed, features, support, ROI</div>
                </div>
                
                <div class="input-group">
                    <label for="improvements">Variations Needed / Comments</label>
                    <textarea id="improvements" placeholder="What variations or other elements need to come into play for this to work better? What did you learn?"></textarea>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="calculateHypothesis()">Evaluate Hypothesis</button>
                <button class="btn btn-secondary" onclick="saveHypothesis()">Save Hypothesis</button>
            </div>
        </div>
        
        <!-- Results Section -->
        <div class="results" id="results">
            <h3>Hypothesis Evaluation Results</h3>
            
            <div class="result-grid">
                <div class="result-card">
                    <div class="result-card-title">Investment</div>
                    <div class="result-card-value" id="totalInvestment">$0</div>
                    <div class="result-card-subtitle">Time × Rate</div>
                </div>
                <div class="result-card primary">
                    <div class="result-card-title">ROI</div>
                    <div class="result-card-value" id="roi">0%</div>
                    <div class="result-card-subtitle">Return on Investment</div>
                </div>
                <div class="result-card">
                    <div class="result-card-title">Efficiency Score</div>
                    <div class="result-card-value" id="efficiency">0</div>
                    <div class="result-card-subtitle">Impact per Hour</div>
                </div>
                <div class="result-card">
                    <div class="result-card-title">Validation Status</div>
                    <div class="result-card-value" id="validationStatus">-</div>
                    <div class="result-card-subtitle">Based on offers made</div>
                </div>
            </div>
            
            <div id="recommendation"></div>
            
            <div class="status-box" style="background: var(--neutral-offwhite); border-color: var(--neutral-gray-300);">
                <strong>Next Steps Calculator</strong>
                <div style="margin-top: var(--space-md);">
                    <p>Recommended future effort: <strong id="futureEffort">0</strong> hours</p>
                    <p>Expected additional impact: <strong id="expectedImpact">0</strong> units</p>
                    <p>Projected total ROI: <strong id="projectedROI">0%</strong></p>
                </div>
            </div>
        </div>
        
        <!-- Comparison Dashboard -->
        <div class="dashboard" id="dashboard" style="display: none;">
            <div class="dashboard-header">
                <h2 style="font-size: 2rem; font-weight: 300;">Hypothesis Comparison Dashboard</h2>
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportToPDF()">📄 PDF Report</button>
                    <button class="export-btn" onclick="exportToCSV()">📊 CSV Data</button>
                    <button class="export-btn" onclick="shareResults()">🔗 Share Link</button>
                </div>
            </div>
            
            <div class="dashboard-tabs">
                <button class="dashboard-tab active" data-filter="all">All Hypotheses</button>
                <button class="dashboard-tab" data-filter="validated">Validated</button>
                <button class="dashboard-tab" data-filter="partial">In Progress</button>
                <button class="dashboard-tab" data-filter="insufficient">Need More Data</button>
            </div>
            
            <div class="comparison-table-container">
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th data-sort="hypothesis">Hypothesis ↕</th>
                            <th data-sort="version">Version ↕</th>
                            <th data-sort="roi">ROI ↕</th>
                            <th data-sort="impact">Impact ↕</th>
                            <th data-sort="offers">Offers ↕</th>
                            <th data-sort="status">Status ↕</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="comparisonTableBody">
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div id="emptyDashboard" class="empty-state">
                <div class="empty-state-icon">📊</div>
                <h3 style="margin-bottom: var(--space-sm);">No Saved Hypotheses Yet</h3>
                <p>Evaluate and save your first hypothesis to see it here in the comparison dashboard.</p>
            </div>
        </div>
    </div>
    
    <!-- Mobile Quick Entry -->
    <button class="mobile-fab" id="mobileFab" onclick="toggleQuickEntry()">⚡</button>
    
    <div class="mobile-quick-entry" id="mobileQuickEntry">
        <div class="mobile-quick-entry-header">
            <strong id="quickEntryHypothesis">Quick Entry</strong>
            <button class="mobile-quick-entry-close" onclick="toggleQuickEntry()">✕</button>
        </div>
        <div style="margin-bottom: var(--space-md); padding: var(--space-sm); background: var(--neutral-offwhite); border-radius: 4px; font-size: 0.875rem;">
            Offers: <strong id="quickOfferCount">0/30</strong> • Impact: <strong id="quickImpact">0.0</strong> • ROI: <strong id="quickROI">0%</strong>
        </div>
        <div class="mobile-quick-buttons">
            <button class="mobile-quick-btn primary" onclick="quickLogOffer()">
                <span class="mobile-quick-btn-icon">➕</span>
                Log Offer
            </button>
            <button class="mobile-quick-btn secondary" onclick="quickAddTime()">
                <span class="mobile-quick-btn-icon">⏱️</span>
                Add Time
            </button>
        </div>
    </div>

    <script>
        // Global state
        let savedHypotheses = [];
        let offersMade = 0;
        let currentWizardStep = 1;
        let resonatingTags = [];
        let currentSortColumn = 'roi';
        let currentSortDirection = 'desc';
        let currentFilter = 'all';
        
        // Initialize app
        function initializeApp() {
            initializeOfferCounter();
            initializeWizard();
            initializeTagInput();
            initializeDashboard();
            updateImpactUI();
            loadSavedHypotheses();
        }
        
        // Initialize offer counter
        function initializeOfferCounter() {
            const counter = document.getElementById('offerCounter');
            for (let i = 1; i <= 50; i++) {
                const div = document.createElement('div');
                div.className = 'offer-number';
                div.textContent = i;
                div.onclick = () => toggleOffer(i);
                counter.appendChild(div);
            }
        }
        
        // Toggle offer completion
        function toggleOffer(num) {
            const offers = document.querySelectorAll('.offer-number');
            if (offers[num - 1].classList.contains('completed')) {
                for (let i = num - 1; i < offers.length; i++) {
                    offers[i].classList.remove('completed');
                }
                offersMade = num - 1;
            } else {
                for (let i = 0; i < num; i++) {
                    offers[i].classList.add('completed');
                }
                offersMade = num;
            }
            document.getElementById('offerCount').textContent = offersMade;
            updateQuickEntryStats();
        }
        
        // Wizard functionality
        function initializeWizard() {
            document.getElementById('wizardNext').addEventListener('click', () => {
                if (currentWizardStep < 3) {
                    currentWizardStep++;
                    updateWizardStep();
                } else {
                    // Wizard complete
                    document.getElementById('impactWizard').style.display = 'none';
                }
            });
            
            document.getElementById('wizardPrev').addEventListener('click', () => {
                if (currentWizardStep > 1) {
                    currentWizardStep--;
                    updateWizardStep();
                }
            });
            
            document.querySelectorAll('input[name="impactBasis"]').forEach(radio => {
                radio.addEventListener('change', updateImpactUI);
            });
            
            document.getElementById('usersPerUnit').addEventListener('input', updateWizardSummary);
            document.getElementById('revenuePerUnit').addEventListener('input', updateWizardSummary);
        }
        
        function updateWizardStep() {
            // Update step indicators
            document.querySelectorAll('.wizard-step').forEach(step => {
                const stepNum = parseInt(step.dataset.step);
                step.classList.remove('active', 'completed');
                if (stepNum === currentWizardStep) {
                    step.classList.add('active');
                } else if (stepNum < currentWizardStep) {
                    step.classList.add('completed');
                }
            });
            
            // Update content
            document.querySelectorAll('.wizard-content-step').forEach(content => {
                content.classList.remove('active');
                if (parseInt(content.dataset.step) === currentWizardStep) {
                    content.classList.add('active');
                }
            });
            
            // Update buttons
            document.getElementById('wizardPrev').style.display = currentWizardStep === 1 ? 'none' : 'block';
            document.getElementById('wizardNext').textContent = currentWizardStep === 3 ? 'Complete Setup ✓' : 'Next →';
            
            if (currentWizardStep === 2) {
                updateImpactUI();
            } else if (currentWizardStep === 3) {
                updateWizardSummary();
            }
        }
        
        function updateWizardSummary() {
            const basis = getImpactBasis();
            const users = getUsersPerUnit();
            const revenue = getRevenuePerUnit();
            
            let summary = '';
            if (basis === 'users') {
                summary = `1 unit = ${users.toLocaleString()} users`;
            } else if (basis === 'revenue') {
                summary = `1 unit = $${revenue.toLocaleString()} ARR`;
            } else {
                summary = `1 unit = ${users.toLocaleString()} users & $${revenue.toLocaleString()} ARR`;
            }
            
            document.getElementById('wizardSummary').textContent = summary;
            document.getElementById('wizardTargetUsers').textContent = `${users.toLocaleString()} users`;
            document.getElementById('wizardTargetRevenue').textContent = `$${revenue.toLocaleString()} ARR`;
        }
        
        // Impact unit helpers
        function getImpactBasis() {
            const el = document.querySelector('input[name="impactBasis"]:checked');
            return el ? el.value : 'users';
        }
        
        function getUsersPerUnit() {
            const el = document.getElementById('usersPerUnit');
            return el ? Math.max(1, parseFloat(el.value) || 100) : 100;
        }
        
        function getRevenuePerUnit() {
            const el = document.getElementById('revenuePerUnit');
            return el ? Math.max(1, parseFloat(el.value) || 15000) : 15000;
        }
        
        function updateImpactUnitLabel() {
            const basis = getImpactBasis();
            const users = getUsersPerUnit();
            const revenue = getRevenuePerUnit();
            const label = document.getElementById('impactUnitLabel');
            if (!label) return;
            
            if (basis === 'users') {
                label.textContent = `(1 unit = ${users.toLocaleString()} users)`;
            } else if (basis === 'revenue') {
                label.textContent = `(1 unit = $${revenue.toLocaleString()} ARR)`;
            } else {
                label.textContent = `(1 unit = ${users.toLocaleString()} users & $${revenue.toLocaleString()} ARR)`;
            }
        }
        
        function updateImpactDisplay() {
            const impact = parseFloat(document.getElementById('impactSlider').value) || 0;
            const users = getUsersPerUnit();
            const revenue = getRevenuePerUnit();
            
            const customers = Math.round(impact * users);
            const revenueAmount = Math.round(impact * revenue);
            
            document.getElementById('impactValue').textContent = impact.toFixed(1);
            document.getElementById('impactCustomers').textContent = customers.toLocaleString();
            document.getElementById('impactRevenue').textContent = revenueAmount.toLocaleString();
            updateQuickEntryStats();
        }
        
        function updateImpactUI() {
            const basis = getImpactBasis();
            const usersGroup = document.getElementById('usersPerUnitGroup');
            const revenueGroup = document.getElementById('revenuePerUnitGroup');
            
            if (usersGroup) usersGroup.style.display = (basis === 'users' || basis === 'both') ? 'block' : 'none';
            if (revenueGroup) revenueGroup.style.display = (basis === 'revenue' || basis === 'both') ? 'block' : 'none';
            
            updateImpactUnitLabel();
            updateImpactDisplay();
        }
        
        // Tag input functionality
        function initializeTagInput() {
            const input = document.getElementById('resonatingInput');
            const container = document.getElementById('resonatingTagsContainer');
            
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && input.value.trim()) {
                    e.preventDefault();
                    addTag(input.value.trim());
                    input.value = '';
                }
            });
            
            // Suggested tags
            document.querySelectorAll('.suggested-tag').forEach(tag => {
                tag.addEventListener('click', () => {
                    addTag(tag.dataset.tag);
                });
            });
        }
        
        function addTag(tagText) {
            if (resonatingTags.includes(tagText)) return;
            
            resonatingTags.push(tagText);
            
            const tag = document.createElement('div');
            tag.className = 'tag';
            tag.innerHTML = `
                ${tagText}
                <span class="tag-remove" onclick="removeTag('${tagText}')">✕</span>
            `;
            
            const input = document.getElementById('resonatingInput');
            const container = document.getElementById('resonatingTagsContainer');
            container.insertBefore(tag, input);
        }
        
        function removeTag(tagText) {
            resonatingTags = resonatingTags.filter(t => t !== tagText);
            renderTags();
        }
        
        function renderTags() {
            const container = document.getElementById('resonatingTagsContainer');
            const input = document.getElementById('resonatingInput');
            
            // Remove all tags
            container.querySelectorAll('.tag').forEach(tag => tag.remove());
            
            // Re-add tags
            resonatingTags.forEach(tagText => {
                const tag = document.createElement('div');
                tag.className = 'tag';
                tag.innerHTML = `
                    ${tagText}
                    <span class="tag-remove" onclick="removeTag('${tagText}')">✕</span>
                `;
                container.insertBefore(tag, input);
            });
        }
        
        // Handle sliders
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('completionSlider').addEventListener('input', function() {
                document.getElementById('completionValue').textContent = this.value + '%';
            });
            
            document.getElementById('impactSlider').addEventListener('input', function() {
                updateImpactDisplay();
            });
            
            document.getElementById('confidenceSlider').addEventListener('input', function() {
                document.getElementById('confidenceValue').textContent = this.value + '%';
            });
            
            document.getElementById('usersPerUnit').addEventListener('input', () => {
                updateImpactUnitLabel();
                updateImpactDisplay();
            });
            
            document.getElementById('revenuePerUnit').addEventListener('input', () => {
                updateImpactUnitLabel();
                updateImpactDisplay();
            });
        });
        
        // Calculate hypothesis evaluation
        function calculateHypothesis() {
            const hypothesis = document.getElementById('hypothesis').value;
            const timeSpent = parseFloat(document.getElementById('timeSpent').value) || 0;
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 0;
            const completion = parseFloat(document.getElementById('completionSlider').value) / 100;
            const impact = parseFloat(document.getElementById('impactSlider').value);
            const confidence = parseFloat(document.getElementById('confidenceSlider').value) / 100;
            
            if (!hypothesis || timeSpent === 0) {
                alert('Please enter a hypothesis and time spent');
                return;
            }
            
            // Calculate metrics
            const investment = timeSpent * hourlyRate;
            const revenuePerUnit = getRevenuePerUnit();
            const revenueGenerated = impact * revenuePerUnit * confidence;
            const roi = investment > 0 ? ((revenueGenerated - investment) / investment * 100) : 0;
            const efficiency = timeSpent > 0 ? (impact / timeSpent) : 0;
            
            // Determine validation status
            let validationStatus = '';
            if (offersMade >= 30) {
                validationStatus = 'Validated';
            } else if (offersMade >= 20) {
                validationStatus = 'Nearly Valid';
            } else if (offersMade >= 10) {
                validationStatus = 'Partial Data';
            } else {
                validationStatus = 'Insufficient';
            }
            
            // Calculate future recommendations
            let futureEffort = 0;
            let expectedAdditionalImpact = 0;
            
            if (roi > 100 && completion < 1) {
                futureEffort = Math.round(timeSpent * (1 - completion));
                expectedAdditionalImpact = (impact / completion) - impact;
            } else if (roi > 50 && roi <= 100) {
                futureEffort = Math.round(timeSpent * 0.25);
                expectedAdditionalImpact = impact * 0.25;
            } else if (roi <= 50 && completion < 0.5) {
                futureEffort = 5;
                expectedAdditionalImpact = 0.1;
            }
            
            const projectedTotalROI = ((revenueGenerated + expectedAdditionalImpact * revenuePerUnit * confidence) - 
                                      (investment + futureEffort * hourlyRate)) / 
                                     (investment + futureEffort * hourlyRate) * 100;
            
            // Update results
            document.getElementById('totalInvestment').textContent = '$' + investment.toLocaleString();
            document.getElementById('roi').textContent = roi.toFixed(0) + '%';
            document.getElementById('efficiency').textContent = efficiency.toFixed(2);
            document.getElementById('validationStatus').textContent = validationStatus;
            
            document.getElementById('futureEffort').textContent = futureEffort;
            document.getElementById('expectedImpact').textContent = expectedAdditionalImpact.toFixed(1);
            document.getElementById('projectedROI').textContent = projectedTotalROI.toFixed(0) + '%';
            
            // Generate recommendation
            const recommendation = document.getElementById('recommendation');
            
            if (roi > 200 && validationStatus === 'Validated') {
                recommendation.innerHTML = `
                    <div class="status-box success-box">
                        <strong>Scale Immediately</strong>
                        Strong validation with ${roi.toFixed(0)}% ROI. This hypothesis is proven.
                        Allocate ${futureEffort} more hours to maximize impact.
                        Consider creating a dedicated system or team for this approach.
                    </div>
                `;
            } else if (roi > 100) {
                recommendation.innerHTML = `
                    <div class="status-box success-box">
                        <strong>Continue & Optimize</strong>
                        Good performance with ${roi.toFixed(0)}% ROI.
                        ${validationStatus === 'Validated' ? 'Fully validated.' : 'Need ' + (30 - offersMade) + ' more offers for full validation.'}
                        Focus on the resonating elements you've identified.
                    </div>
                `;
            } else if (roi > 0) {
                recommendation.innerHTML = `
                    <div class="status-box warning-box">
                        <strong>Pivot or Refine</strong>
                        Marginal performance at ${roi.toFixed(0)}% ROI.
                        ${completion < 0.5 ? 'Only ' + (completion * 100).toFixed(0) + '% complete - may improve with more execution.' : ''}
                        Review your variations and test a modified approach.
                    </div>
                `;
            } else {
                recommendation.innerHTML = `
                    <div class="status-box warning-box">
                        <strong>Consider Abandoning</strong>
                        Negative ROI at ${roi.toFixed(0)}%.
                        ${offersMade < 20 ? 'However, only ' + offersMade + ' offers made - need more data.' : ''}
                        ${futureEffort > 0 ? 'Small test of ' + futureEffort + ' hours may provide clarity.' : 'Move resources to more promising hypotheses.'}
                    </div>
                `;
            }
            
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
            updateQuickEntryStats();
        }
        
        // Save hypothesis
        function saveHypothesis() {
            const hypothesis = document.getElementById('hypothesis').value;
            if (!hypothesis || document.getElementById('results').style.display !== 'block') {
                alert('Please evaluate a hypothesis first');
                return;
            }
            
            const saved = {
                id: Date.now(),
                hypothesis: hypothesis,
                version: parseInt(document.getElementById('version').value) || 1,
                completion: document.getElementById('completionSlider').value + '%',
                impact: parseFloat(document.getElementById('impactSlider').value) || 0,
                roi: document.getElementById('roi').textContent,
                roiNumeric: parseFloat(document.getElementById('roi').textContent) || 0,
                offers: parseInt(offersMade) || 0,
                efficiency: parseFloat(document.getElementById('efficiency').textContent) || 0,
                validationStatus: document.getElementById('validationStatus').textContent,
                resonatingTags: [...resonatingTags],
                improvements: document.getElementById('improvements').value,
                timestamp: new Date().toISOString(),
                timestampDisplay: new Date().toLocaleString()
            };
            
            savedHypotheses.push(saved);
            localStorage.setItem('ascendHypotheses', JSON.stringify(savedHypotheses));
            
            updateDashboard();
            alert('Hypothesis saved! View it in the comparison dashboard below.');
            
            // Scroll to dashboard
            setTimeout(() => {
                document.getElementById('dashboard').scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        // Dashboard functionality
        function initializeDashboard() {
            // Tab filtering
            document.querySelectorAll('.dashboard-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.dashboard-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentFilter = tab.dataset.filter;
                    updateDashboard();
                });
            });
            
            // Column sorting
            document.querySelectorAll('.comparison-table th[data-sort]').forEach(th => {
                th.addEventListener('click', () => {
                    const column = th.dataset.sort;
                    if (currentSortColumn === column) {
                        currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSortColumn = column;
                        currentSortDirection = 'desc';
                    }
                    updateDashboard();
                });
            });
        }
        
        function updateDashboard() {
            if (savedHypotheses.length === 0) {
                document.getElementById('dashboard').style.display = 'none';
                return;
            }
            
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('emptyDashboard').style.display = 'none';
            
            // Filter hypotheses
            let filtered = [...savedHypotheses];
            if (currentFilter !== 'all') {
                filtered = filtered.filter(h => {
                    const status = h.validationStatus.toLowerCase();
                    if (currentFilter === 'validated') return status === 'validated';
                    if (currentFilter === 'partial') return status === 'partial data' || status === 'nearly valid';
                    if (currentFilter === 'insufficient') return status === 'insufficient';
                    return true;
                });
            }
            
            // Sort hypotheses
            filtered.sort((a, b) => {
                let aVal, bVal;
                switch (currentSortColumn) {
                    case 'hypothesis':
                        aVal = (a.hypothesis || '').toLowerCase();
                        bVal = (b.hypothesis || '').toLowerCase();
                        break;
                    case 'version':
                        aVal = parseInt(a.version) || 1;
                        bVal = parseInt(b.version) || 1;
                        break;
                    case 'roi':
                        aVal = parseFloat(a.roiNumeric) || parseFloat(a.roi) || 0;
                        bVal = parseFloat(b.roiNumeric) || parseFloat(b.roi) || 0;
                        break;
                    case 'impact':
                        aVal = parseFloat(a.impact) || 0;
                        bVal = parseFloat(b.impact) || 0;
                        break;
                    case 'offers':
                        aVal = parseInt(a.offers) || 0;
                        bVal = parseInt(b.offers) || 0;
                        break;
                    case 'status':
                        aVal = a.validationStatus || '';
                        bVal = b.validationStatus || '';
                        break;
                    default:
                        aVal = parseFloat(a.roiNumeric) || parseFloat(a.roi) || 0;
                        bVal = parseFloat(b.roiNumeric) || parseFloat(b.roi) || 0;
                }
                
                if (currentSortDirection === 'asc') {
                    return aVal > bVal ? 1 : -1;
                } else {
                    return aVal < bVal ? 1 : -1;
                }
            });
            
            // Render table
            const tbody = document.getElementById('comparisonTableBody');
            tbody.innerHTML = '';
            
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: var(--neutral-gray-600);">No hypotheses match this filter</td></tr>';
                return;
            }
            
            filtered.forEach(h => {
                const row = document.createElement('tr');
                
                // Safely parse impact value (handle both string and number)
                const impactValue = parseFloat(h.impact) || 0;
                const roiValue = parseFloat(h.roiNumeric) || parseFloat(h.roi) || 0;
                const offersValue = parseInt(h.offers) || 0;
                
                let statusClass = 'insufficient';
                if (h.validationStatus === 'Validated') statusClass = 'validated';
                else if (h.validationStatus === 'Partial Data' || h.validationStatus === 'Nearly Valid') statusClass = 'partial';
                
                let roiColor = '#666';
                if (roiValue > 100) roiColor = 'var(--secondary-olive)';
                else if (roiValue < 0) roiColor = 'var(--accent-crimson)';
                
                row.innerHTML = `
                    <td><strong>${h.hypothesis}</strong></td>
                    <td>v${h.version || 1}</td>
                    <td style="color: ${roiColor}; font-weight: bold;">${h.roi}</td>
                    <td>${impactValue.toFixed(1)}</td>
                    <td>${offersValue} / 30</td>
                    <td><span class="status-badge ${statusClass}">${h.validationStatus}</span></td>
                    <td class="action-buttons">
                        <button class="action-btn" onclick="viewHypothesis(${h.id})" title="View">👁️</button>
                        <button class="action-btn" onclick="deleteHypothesis(${h.id})" title="Delete">🗑️</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        function loadSavedHypotheses() {
            const saved = localStorage.getItem('ascendHypotheses');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    
                    // Migrate old data format to new format
                    savedHypotheses = parsed.map(h => ({
                        ...h,
                        id: h.id || Date.now() + Math.random(),
                        impact: parseFloat(h.impact) || 0,
                        roiNumeric: parseFloat(h.roiNumeric) || parseFloat(h.roi) || 0,
                        offers: parseInt(h.offers) || 0,
                        version: parseInt(h.version) || 1,
                        efficiency: parseFloat(h.efficiency) || 0,
                        resonatingTags: Array.isArray(h.resonatingTags) ? h.resonatingTags : [],
                        improvements: h.improvements || '',
                        validationStatus: h.validationStatus || 'Insufficient'
                    }));
                    
                    // Save migrated data back to localStorage
                    localStorage.setItem('ascendHypotheses', JSON.stringify(savedHypotheses));
                    
                    updateDashboard();
                } catch (e) {
                    console.error('Error loading saved hypotheses:', e);
                    // If data is corrupted, ask user if they want to reset
                    if (confirm('There was an error loading your saved hypotheses. The data may be corrupted. Would you like to reset and start fresh?')) {
                        localStorage.removeItem('ascendHypotheses');
                        savedHypotheses = [];
                        updateDashboard();
                    }
                }
            }
        }
        
        function viewHypothesis(id) {
            const h = savedHypotheses.find(hyp => hyp.id === id);
            if (!h) return;
            
            const impactValue = parseFloat(h.impact) || 0;
            const tagsDisplay = h.resonatingTags && h.resonatingTags.length > 0 ? h.resonatingTags.join(', ') : 'None';
            
            alert(`${h.hypothesis}\n\nVersion: ${h.version || 1}\nROI: ${h.roi}\nImpact: ${impactValue.toFixed(1)}\nOffers: ${h.offers || 0}\nStatus: ${h.validationStatus}\n\nResonating Tags: ${tagsDisplay}\n\nSaved: ${h.timestampDisplay}`);
        }
        
        function deleteHypothesis(id) {
            if (!confirm('Are you sure you want to delete this hypothesis?')) return;
            
            savedHypotheses = savedHypotheses.filter(h => h.id !== id);
            localStorage.setItem('ascendHypotheses', JSON.stringify(savedHypotheses));
            updateDashboard();
        }
        
        // Export functions
        function exportToPDF() {
            alert('PDF export feature coming soon! This will generate a professional report of all your hypotheses.');
        }
        
        function exportToCSV() {
            if (savedHypotheses.length === 0) {
                alert('No hypotheses to export');
                return;
            }
            
            let csv = 'Hypothesis,Version,ROI,Impact,Offers,Status,Timestamp\n';
            savedHypotheses.forEach(h => {
                const impactValue = parseFloat(h.impact) || 0;
                const versionValue = parseInt(h.version) || 1;
                const offersValue = parseInt(h.offers) || 0;
                csv += `"${h.hypothesis}",${versionValue},${h.roi},${impactValue.toFixed(1)},${offersValue},"${h.validationStatus}","${h.timestampDisplay}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ascend-hypotheses.csv';
            a.click();
        }
        
        function shareResults() {
            alert('Share feature coming soon! This will generate a secure link to share your hypothesis results with your team.');
        }
        
        // Mobile quick entry
        function toggleQuickEntry() {
            const entry = document.getElementById('mobileQuickEntry');
            entry.classList.toggle('active');
        }
        
        function updateQuickEntryStats() {
            document.getElementById('quickOfferCount').textContent = `${offersMade}/30`;
            document.getElementById('quickImpact').textContent = (parseFloat(document.getElementById('impactSlider').value) || 0).toFixed(1);
            const roiText = document.getElementById('roi').textContent;
            document.getElementById('quickROI').textContent = roiText || '0%';
            
            const hypothesis = document.getElementById('hypothesis').value;
            if (hypothesis) {
                document.getElementById('quickEntryHypothesis').textContent = hypothesis.substring(0, 30) + (hypothesis.length > 30 ? '...' : '');
            }
        }
        
        function quickLogOffer() {
            if (offersMade < 50) {
                toggleOffer(offersMade + 1);
                // Show brief confirmation
                const btn = event.target.closest('.mobile-quick-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<span class="mobile-quick-btn-icon">✓</span>Logged!';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 1000);
            } else {
                alert('Maximum offers reached!');
            }
        }
        
        function quickAddTime() {
            const current = parseFloat(document.getElementById('timeSpent').value) || 0;
            const add = prompt('How many hours to add?', '1');
            if (add) {
                document.getElementById('timeSpent').value = current + parseFloat(add);
                alert(`Added ${add} hours. Total: ${current + parseFloat(add)} hours`);
            }
        }
        
        // Initialize on load
        window.addEventListener('load', initializeApp);
    </script>
</body>
</html>
